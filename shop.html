<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHOP</title>
    <link rel="stylesheet" href="shop.css">
</head>

<body>

    <form action="">
        <div id="search-container">
            <select id="gender">
                <option value="Male">Male</option>
                <option value="Female">Female</option>
            </select>
            <button type="submit">search</button>
        </div>
        <div id="wrapper"></div>
    </form>

    <script>
        let form = document.querySelector('form')
        let gender = document.querySelector('#gender')
        let button = document.querySelector('button')
        let wrapper = document.querySelector('#wrapper')

        const CloudName = 'da2oqj7qe'
        const malefolder = 'male'
        const femalefolder = 'female'

        form.onsubmit = async (e) => {
            e.preventDefault()

            const data = await fetch('http://localhost:8052/shop', {
                method: "POST",
                headers: {
                    "COntent-Type": "application/json"
                },
                body: JSON.stringify({
                    selectedgender: gender.value
                })
            })
            const result = await data.json()
            console.log(result)

            const imgdata = result.resources


            try {
                showimg()
            } catch (error) {
                console.log('error fetching images :', error)
            }


            function showimg() {
                console.log(imgdata)
                for (let i = 0; i < imgdata.length; i++) {

                    let div = document.createElement('div')
                    div.className = 'products'

                    let image = document.createElement('img')
                    image.src = imgdata[i].url

                    let addToCartButton = document.createElement('button')
                    addToCartButton.textContent='Add to Cart'
                    addToCartButton.onclick=()=>{
                        console.log('product added',imgdata[i].url)
                    }

                    div.append(image,addToCartButton)
                    wrapper.append(div)
                }
            }
        }
        
    </script>
</body>

</html>